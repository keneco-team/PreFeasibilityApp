import{cW as C,e0 as j,e1 as h,e2 as S,e3 as R,e4 as w,a$ as x,e5 as O,bK as $,e6 as v,e7 as B,at as W,e8 as Y,e9 as z,ea as J,b0 as G,eb as K}from"./index-Cey3Bnmd.js";import{e as q}from"./mat3f64-q3fE-ZOt.js";import{o as g,e as D}from"./mat4f64-CSKppSlJ.js";import{a as E}from"./spatialReferenceEllipsoidUtils-DiFxLxw2.js";import{u as L}from"./computeTranslationToOriginAndRotation-CY8oYY1j.js";import{t as V,o as H}from"./DoubleArray-BJ2UuN2I.js";import{i as P,T as y}from"./BufferView-BGJ71b9y.js";import{f as I,l as b,e as k}from"./vec3-BJ9vVGCJ.js";import{n as Q}from"./vec4-B1i2I-vA.js";const cr="Projection may be possible after calling projection.load().";function lr(r,e,o,t){r.error(`Failed to project from (wkid:${e.wkid}) to (wkid:${o.wkid}).${t?" ":""}${t}`)}function ur(r,e,o,t,n){return M(T.TO_PCPF,P.fromTypedArray(r),m.NORMAL,y.fromTypedArray(e),y.fromTypedArray(o),t,P.fromTypedArray(n))?n:null}function pr(r,e,o,t,n){return M(T.FROM_PCPF,P.fromTypedArray(r),m.NORMAL,y.fromTypedArray(e),y.fromTypedArray(o),t,P.fromTypedArray(n))?n:null}function mr(r,e,o){return C(r,e,0,o,E(e),0,r.length/3)?o:null}function Tr(r,e,o){return C(r,E(o),0,e,o,0,r.length/3)?e:null}function Pr(r,e,o){return j(s,o),I(e,r,s),h(s)&&b(e,e),e}function yr(r,e,o){return S(s,o),Q(e,r,s),h(s)&&b(e,e,4),e}function Ar(r,e,o,t,n){if(!M(T.TO_PCPF,P.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),m.TANGENT,y.fromTypedArray(e),y.fromTypedArray(o),t,P.fromTypedArray(n,4*Float32Array.BYTES_PER_ELEMENT)))return null;for(let f=3;f<r.length;f+=4)n[f]=r[f];return n}function Fr(r,e,o,t,n){if(!M(T.FROM_PCPF,P.fromTypedArray(r,16),m.TANGENT,y.fromTypedArray(e),y.fromTypedArray(o),t,P.fromTypedArray(n,16)))return null;for(let f=3;f<r.length;f+=4)n[f]=r[f];return n}var m,T;function _(r,e,o,t,n){switch(L(t,o,p,t),r===T.FROM_PCPF&&K(p,p),e){case m.NORMAL:return j(n,p);case m.TANGENT:return S(n,p)}}function M(r,e,o,t,n,f,u){if(!e)return;const c=t.count,A=E(f);if(U(f))for(let i=0;i<c;i++)n.getVec(i,N),e.getVec(i,l),R(l,l,_(r,o,N,A,s)),u.setVec(i,l);else for(let i=0;i<c;i++){n.getVec(i,N),e.getVec(i,l);const F=w(t.get(i,1));let a=Math.cos(F);o===m.TANGENT!=(r===T.TO_PCPF)&&(a=1/a),_(r,o,N,A,s),r===T.TO_PCPF?(s[0]*=a,s[1]*=a,s[2]*=a,s[3]*=a,s[4]*=a,s[5]*=a):(s[0]*=a,s[3]*=a,s[6]*=a,s[1]*=a,s[4]*=a,s[7]*=a),R(l,l,s),x(l,l),u.setVec(i,l)}return u}function dr(r){return r.vertexSpace.type==="local"?X(r):Z(r)}function X({vertexSpace:r,transform:e,inSpatialReference:o,outSpatialReference:t,localMode:n,outPositions:f,positions:u}){const c=r.origin??O,A=r.origin!=null?(e==null?void 0:e.localMatrix)??g:g,i=E(o),F=t.isWebMercator&&n||!$(o,i)?o:i;L(o,c,p,F),v(p,p,A);const a=f??V(u.length);return k(a,u,p),C(a,F,0,a,t,0,a.length/3),a}function Z({vertexSpace:r,transform:e,outPositions:o,positions:t,inSpatialReference:n,outSpatialReference:f}){const u=r.origin!=null?(e==null?void 0:e.localMatrix)??g:g,c=o??V(t.length);B(u,g)?H(c,t):k(c,t,u);const A=r.origin??O;if(!W(A,O)){const[i,F,a]=A;for(let d=0;d<c.length;d+=3)c[d]+=i,c[d+1]+=F,c[d+2]+=a}return C(c,n,0,c,f,0,c.length/3)?c:null}function U(r){return r.isWGS84||Y(r)||z(r)||J(r)}(function(r){r[r.NORMAL=0]="NORMAL",r[r.TANGENT=1]="TANGENT"})(m||(m={})),function(r){r[r.TO_PCPF=0]="TO_PCPF",r[r.FROM_PCPF=1]="FROM_PCPF"}(T||(T={}));const N=G(),l=G(),p=D(),s=q();export{m as VectorType,cr as loadProjectErrorMessage,lr as logProjectionError,dr as project,Tr as projectFromPCPF,pr as projectNormalFromPCPF,ur as projectNormalToPCPF,Fr as projectTangentFromPCPF,Ar as projectTangentToPCPF,mr as projectToPCPF,Pr as transformNormal,yr as transformTangent};
